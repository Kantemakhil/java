OFFENDER_SENTENCES_T3_IS_DRR_CUR{
SELECT 'X' FROM sentence_calc_types WHERE sentence_category = :sentenceCategory AND sentence_calc_type = :sentenceCalcType AND program_method = 'DRR'
}
OFFENDER_SENTENCES_T3_OFFENDER_SENTENCES{
SELECT OFFENDER_BOOK_ID,SENTENCE_SEQ,ORDER_ID,SENTENCE_CALC_TYPE,SENTENCE_STATUS,CONSEC_TO_SENTENCE_SEQ,START_DATE,END_DATE,COMMENT_TEXT,TERMINATION_REASON,NO_OF_UNEXCUSED_ABSENCE,CASE_ID,ETD_CALCULATED_DATE,MTD_CALCULATED_DATE,LTD_CALCULATED_DATE,ARD_CALCULATED_DATE,CRD_CALCULATED_DATE,PED_CALCULATED_DATE,APD_CALCULATED_DATE,NPD_CALCULATED_DATE,LED_CALCULATED_DATE,SED_CALCULATED_DATE,PRRD_CALCULATED_DATE,TARIFF_CALCULATED_DATE,AGG_SENTENCE_SEQ,SENTENCE_CATEGORY,FINE_AMOUNT,HDCED_CALCULATED_DATE,SENTENCE_TEXT,REVOKED_DATE,REVOKED_STAFF_ID,BREACH_LEVEL,CREATE_DATETIME,CREATE_USER_ID,MODIFY_DATETIME,MODIFY_USER_ID,TERMINATION_DATE,AGGREGATE_TERM,AGGREGATE_ADJUST_DAYS,SENTENCE_LEVEL,EXTENDED_DAYS,COUNTS,DISCHARGE_DATE,STATUS_UPDATE_REASON,STATUS_UPDATE_COMMENT,STATUS_UPDATE_DATE,STATUS_UPDATE_STAFF_ID,CHARGE_SEQ,SUPERVISION_EXPIRY_DATE,LINE_SEQ,NOMSENTDETAILREF,NOMCONSTOSENTDETAILREF,NOMCONSFROMSENTDETAILREF,NOMCONCWITHSENTDETAILREF,WORKFLOW_ID,SEAL_FLAG,LRD_CALCULATED_DATE,RED_CALCULATED_DATE,SENTENCE_TERM,ELIGIBLE_REMISSION,RED_BKG_DATE,ADJUST_REMISSION FROM OFFENDER_SENTENCES WHERE OFFENDER_BOOK_ID=:offenderBookId AND SENTENCE_SEQ=:sentenceSeq
}
OFFENDER_SENTENCES_T3_INSERT{
 INSERT INTO offender_prg_obligations(offender_prg_obligation_id, offender_book_id, offender_sent_condition_id, sentence_seq, referral_date,end_date, event_type,create_datetime,modify_datetime,create_user_id) VALUES (offender_prg_obligation_id.NEXTVAL,:offenderBookId, NULL,:sentenceSeq, :referralDate, :endDate, 'DRR',createDatetime,modifyDatetime,:createUserId )
}
OFFENDER_SENTENCES_T3_UPDATE{
UPDATE offender_prg_obligations SET referral_date = :startDate,  end_date = :endDate,modify_datetime=CURRENT_TIMESTAMP,modify_user_id=:modifyUserId  WHERE offender_book_id = :offenderBookId AND sentence_seq = :sentenceSeq AND :sentenceLevel = 'IND' AND :sentenceStatus = 'A'
}