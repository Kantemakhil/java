
OMURMRES_FIND_CGFKRESBLREMOVEREASON {
 	SELECT REF_CODE.CODE  REMOVE_REASON        ,REF_CODE.DOMAIN  DSP_DOMAIN        ,REF_CODE.DESCRIPTION  DSP_DESCRIPTION FROM   REFERENCE_CODES REF_CODE WHERE 
 	REF_CODE.DOMAIN = 'CHG_HOUS_RSN' AND ACTIVE_FLAG = 'Y' AND EXPIRED_DATE IS NULL
}

OMURMRES_RESBL_FIND_RESERVE_BED_LOCATIONS {
 	SELECT AGY_LOC_ID ,LIVING_UNIT_ID ,RESERVE_UNTIL_DATE ,REMOVE_REASON ,COMMENT_TEXT ,OFFENDER_ID ,RESERVE_BED_ID ,CREATE_DATETIME ,CREATE_USER_ID 
 	,MODIFY_DATETIME ,MODIFY_USER_ID ,SEAL_FLAG   FROM RESERVE_BED_LOCATIONS  
}
OMURMRES_RESBL_INSERT_RESERVE_BED_LOCATIONS {
insert into RESERVE_BED_LOCATIONS(AGY_LOC_ID , LIVING_UNIT_ID , RESERVE_UNTIL_DATE , REMOVE_REASON , COMMENT_TEXT , OFFENDER_ID , RESERVE_BED_ID , CREATE_DATETIME , CREATE_USER_ID , MODIFY_DATETIME , SEAL_FLAG ) values(:agyLocId , :livingUnitId , :reserveUntilDate , :removeReason , :commentText , :offenderId , :reserveBedId , current_timestamp, :createUserId , null, :sealFlag )
}

OMURMRES_RESBL_UPDATE_RESERVE_BED_LOCATIONS {
update RESERVE_BED_LOCATIONS set AGY_LOC_ID = :agyLocId , LIVING_UNIT_ID = :livingUnitId , RESERVE_UNTIL_DATE = :reserveUntilDate , REMOVE_REASON = :removeReason , COMMENT_TEXT = :commentText , OFFENDER_ID = :offenderId , RESERVE_BED_ID = :reserveBedId , MODIFY_DATETIME = current_timestamp , MODIFY_USER_ID = :modifyUserId , SEAL_FLAG = :sealFlag 
}

OMURMRES_RESBL_DELETE_RESERVE_BED_LOCATIONS { 
	DELETE FROM RESERVE_BED_LOCATIONS where RESERVE_BED_ID = :reserveBedId
}

OMURMRES_SYSPFL_FIND_SYSTEM_PROFILES {
 	SELECT PROFILE_TYPE ,PROFILE_CODE ,DESCRIPTION ,PROFILE_VALUE ,PROFILE_VALUE_2 ,MODIFY_USER_ID ,OLD_TABLE_NAME ,CREATE_DATETIME ,CREATE_USER_ID ,MODIFY_DATETIME ,SEAL_FLAG   FROM SYSTEM_PROFILES  
}
OMURMRES_SYSPFL_INSERT_SYSTEM_PROFILES {
	INSERT INTO SYSTEM_PROFILES(PROFILE_TYPE ,PROFILE_CODE ,DESCRIPTION ,PROFILE_VALUE ,PROFILE_VALUE_2 ,MODIFY_USER_ID ,OLD_TABLE_NAME ,CREATE_DATETIME ,CREATE_USER_ID ,MODIFY_DATETIME ,SEAL_FLAG )
	VALUES(:profileType ,:profileCode ,:description ,:profileValue ,:profileValue2 ,:modifyUserId ,:oldTableName ,current_timestamp,:createUserId ,null,:sealFlag )
}

OMURMRES_SYSPFL_DELETE_SYSTEM_PROFILES { 
	DELETE FROM SYSTEM_PROFILES
}


OMURMRES_CGFKCHK_RES_BL_RES_BL_REF_COD_ {
	SELECT REF_CODE.DOMAIN ,REF_CODE.DESCRIPTION FROM   REFERENCE_CODES REF_CODE WHERE  REF_CODE.CODE = :REMOVEREASON AND     REF_CODE.DOMAIN = 'CHG_HOUS_RSN' AND ACTIVE_FLAG = 'Y' AND EXPIRED_DATE IS NULL
}

OMURMRES_CGFKCHK_RES_BL_RES_BL_V_HB_F1 {
	SELECT V_OFF_BKG.LAST_NAME ,V_OFF_BKG.FIRST_NAME ,V_OFF_BKG.LIVING_UNIT_DESCRIPTION FROM   V_HEADER_BLOCK_FN(:USERID)  V_OFF_BKG WHERE  V_OFF_BKG.ROOT_OFFENDER_ID = :OFFENDERID
}
OMURMRES_INSERT_BED_ASSIGNMENT_HISTORIES {
insert into BED_ASSIGNMENT_HISTORIES(OFFENDER_BOOK_ID , BED_ASSIGN_SEQ , LIVING_UNIT_ID , ASSIGNMENT_DATE , ASSIGNMENT_TIME , ASSIGNMENT_REASON , CREATE_DATETIME , CREATE_USER_ID , MODIFY_DATETIME)
values(:offenderBookId , :bedAssignSeq , :livingUnitId , :assignmentDate , :assignmentTime , :assignmentReason , current_timestamp, :createUserId , current_timestamp)
}
OMURMRES_BED_AH_PREINSERT {
	
	SELECT coalesce (MAX(BED_ASSIGN_SEQ),0) + 1 FROM BED_ASSIGNMENT_HISTORIES WHERE OFFENDER_BOOK_ID = :OFFENDERBOOKID
}
OMURMRES_UPDATE_OFFENDER_BOOKINGS {
update OFFENDER_BOOKINGS set LIVING_UNIT_ID = :livingUnitId, MODIFY_DATETIME = current_timestamp , modify_user_id = :modifyUserId  where OFFENDER_BOOK_ID =:offenderBookId
}
 OMURMRES_DISPLAY_ITEMS_CURSOR {
  select
	VHB.LAST_NAME ,
	VHB.FIRST_NAME ,
	VHB.OFFENDER_ID_DISPLAY ,
	VHB.OFFENDER_BOOK_ID ,
	VHB.LIVING_UNIT_DESCRIPTION,
	VHB.AGY_LOC_ID,
	VHB.LIV_UNIT_DESC
from
	V_HEADER_BLOCK_FN(:USERID) VHB
where
	VHB.ROOT_OFFENDER_ID = :V_OFFENDER_ID
	and VHB.AGY_LOC_ID = :V_AGY_LOC_ID
	and VHB.ACTIVE_FLAG = 'Y'
	and BOOKING_BEGIN_DATE = (
	select
		MAX(OB.BOOKING_BEGIN_DATE)
	from
		OFFENDER_BOOKINGS OB
	where
		OB.OFFENDER_ID = VHB.OFFENDER_ID)    
 }
 
 GET_OFF_BOOK_OLD_REC{
 select * from OFFENDER_BOOKINGS where offender_book_id = :offender_book_id  
 }
 