
OIIOSCED_FIND_RGSCHTYPE {
SELECT L_REF_CODE.CODE CODE   ,L_REF_CODE.DESCRIPTION DESCRIPTION 
	             FROM   REFERENCE_CODES L_REF_CODE 
	             WHERE  DOMAIN = :domain
	             AND    active_flag = 'Y' 
	             ORDER BY  L_REF_CODE.LIST_SEQ ASC 
	                    ,L_REF_CODE.DESCRIPTION ASC
}

OIIOSCED_FIND_RGSCHREAEXT {
 	SELECT MOVEMENT_REASON_CODE CODE ,DESCRIPTION DESCRIPTION FROM   MOVEMENT_REASONS WHERE MOVEMENT_TYPE = :SCHTYPECODE
}

OIIOSCED_FIND_RGSCHREAINT {
 	SELECT INTERNAL_SCHEDULE_REASONS.INTERNAL_SCHEDULE_RSN_CODE CODE,  INTERNAL_SCHEDULE_REASONS.DESCRIPTION DESCRIPTION FROM INTERNAL_SCHEDULE_REASONS  WHERE  INTERNAL_SCHEDULE_REASONS.INTERNAL_SCHEDULE_TYPE = :SCHTYPECODE
}

OIIOSCED_VOFFENDERALLSCHEDULES_FIND_V_OFFENDER_ALL_SCHEDULES {
select (select DESCRIPTION from movement_reasons where movement_type = 'TAP' and movement_reason_code=voas.EVENT_SUB_TYPE) as tap_description, case when event_type = 'UW' then ( select ( select street_information || ',' || COALESCE(city_code,'') || ',' || COALESCE(prov_state_code ,'') || ',' || country_desc || ',' || zip_postal_code from V_ADDRESSES where address_id = ca.services_address_id  ) as cs_address from course_activities ca where crs_acty_id = ( select crs_acty_id from offender_program_profiles opp where off_prgref_id = voas.off_prgref_id) ) else case when event_type = 'ACP' then case when event_class = 'COMM' then ( select case when ca.provider_type = 'INT' and ca.provider_party_class = 'TEAM' then ( case when ( select count(*) from team_agency_loc tal where tal.team_id = ca.provider_party_id) = 1 then ( select ( select description from agency_locations al2 where agy_loc_id = tal.agy_loc_id) from team_agency_loc tal where tal.team_id = ca.provider_party_id ) else ( select ( select description from agency_locations al2 where agy_loc_id = vhb.intake_agy_loc_id) from v_header_block vhb where offender_book_id = voas.offender_book_id ) end ) else ( case when ca.provider_type = 'INT' and ca.provider_party_class = 'AGY' then ( select description from agency_locations al where agy_loc_id = ca.provider_party_code) else ( select corporate_name from corporates c where corporate_id = provider_party_id) end ) end as location from course_activities ca where ca.crs_acty_id = ( select case when ca.provider_type is null then ca.parent_crs_acty_id else ca.crs_acty_id end from course_activities ca where crs_acty_id = ( select crs_acty_id from offender_program_profiles opp where offender_book_id = voas.offender_book_id and PROFILE_CLASS = 'CRS' and off_prgref_id = voas.off_prgref_id))) else ( select case when provider_party_class = 'AGY' then ( case when ca.internal_location_id is null then ( select description from agency_locations al where agy_loc_id = ca.provider_party_code ) else ( select description from agency_internal_locations ail where internal_location_id = ca.internal_location_id ) end) else ( select corporate_name from corporates c where corporate_id = provider_party_id) end from course_activities ca where crs_acty_id = ( select case when ca.provider_type is null then ca.parent_crs_acty_id else ca.crs_acty_id end from course_activities ca where crs_acty_id = ( select crs_acty_id from offender_program_profiles opp where offender_book_id = voas.offender_book_id and PROFILE_CLASS = 'CRS' and off_prgref_id = voas.off_prgref_id))) end else null end end as cs_address, case when event_type = 'ACP' then (select (select description from program_services ps where program_id = ca.program_id ) from course_activities ca where ca.crs_acty_id = ( select case when ca.provider_type is null then ca.parent_crs_acty_id else ca.crs_acty_id end from course_activities ca where crs_acty_id = ( select crs_acty_id from offender_program_profiles opp where off_prgref_id = voas.off_prgref_id))) else ( ( select description from course_activities ca where crs_acty_id = ( select crs_acty_id from offender_program_profiles opp where off_prgref_id = voas.off_prgref_id) )) end as cs_description, ( select description as oic_hearing_description from reference_codes rc where "domain" = 'OIC_HEAR' and code =( select oic_hearing_type from oic_hearings oh where voas.EVENT_ID = oh.event_id)), ( select description as visit_description from reference_codes rc where "domain" = 'VISIT_TYPE' and code =( select visit_type from offender_visits oh, offender_visit_visitors ovv where oh.offender_book_id = voas.offender_book_id and ovv.offender_visit_id = oh.offender_visit_id and voas.EVENT_ID = ovv.event_id)), ( select ps.description as work_relaese_project_code from COURSE_ACTIVITIES ca, PROGRAM_SERVICES ps where COURSE_ACTIVITY_TYPE = 'WR' and PROVIDER_PARTY_CLASS = 'CORP' and crs_acty_id = ( select crs_acty_id from offender_program_profiles opp where off_prgref_id = voas.off_prgref_id) and ps.program_id = ca.program_id), ( select ( select ct.corporate_name as work_relaese_provide_desc from corporates ct where ct.corporate_id = ca.provider_party_id) from COURSE_ACTIVITIES ca, PROGRAM_SERVICES ps where COURSE_ACTIVITY_TYPE = 'WR' and PROVIDER_PARTY_CLASS = 'CORP' and crs_acty_id = ( select crs_acty_id from offender_program_profiles opp where off_prgref_id = voas.off_prgref_id) and ps.program_id = ca.program_id), voas.EVENT_ID , voas.OFFENDER_BOOK_ID , voas.IN_OUT_STATUS , voas.BOOKING_NO , voas.BOOKING_ACTIVE_FLAG , voas.OFFENDER_ID , voas.OFFENDER_ID_DISPLAY , voas.OFFENDER_LAST_NAME , voas.OFFENDER_FIRST_NAME , voas.EVENT_DATE , voas.START_TIME , voas.END_TIME , voas.EVENT_CLASS , voas.EVENT_TYPE , voas.EVENT_TYPE_DESC , voas.EVENT_SUB_TYPE , voas.EVENT_SUB_TYPE_DESC , voas.ACTIVE_FLAG , voas.EVENT_STATUS , voas.EVENT_STATUS_DESC , voas.EVENT_OUTCOME , voas.EVENT_OUTCOME_DESC , voas.BUSY_DATE_FLAG , voas.OUTCOME_REASON_CODE , voas.REFERENCE_ID , voas.APPLICATION_DATE , voas.APPLICATION_TIME , voas.RETURN_DATE , voas.RETURN_TIME , voas.COMMENT_TEXT , voas.DETAILS , voas.AGY_LOC_ID , voas.AGY_LOC_DESC , voas.LIVING_UNIT_ID , voas.LIVING_UNIT_DESC , voas.LU_LEVEL_1_CODE , voas.LU_LEVEL_2_CODE , voas.LU_LEVEL_3_CODE , voas.LU_LEVEL_4_CODE , voas.AGENCY_IML_ID , voas.AGENCY_IML_DESC , voas.AGENCY_IML_LEVEL_1_CODE , voas.AGENCY_IML_LEVEL_2_CODE , voas.AGENCY_IML_LEVEL_3_CODE , voas.TO_AGY_LOC_ID , voas.TO_AGY_LOC_DESC , voas.TO_LOC , voas.TO_LOC_DESC , voas.ESCORT_CODE , voas.ESCORT_DESC , voas.DIRECTION_CODE , voas.SCHEDULE_MOVEMENT_TIME , voas.FROM_CITY_CODE , voas.FROM_CITY_NAME , voas.TO_CITY_CODE , voas.TO_CITY_NAME , voas.TO_INTERNAL_LOCATION_ID , voas.TO_INTERNAL_LOCATION_DESC , voas.TO_INT_LOC_LEVEL_1_CODE , voas.TO_INT_LOC_LEVEL_2_CODE , voas.TO_INT_LOC_LEVEL_3_CODE , voas.TO_INT_LOC_USER_DESC , CREDITED_HOURS , ENGAGEMENT_CODE , UNDERSTANDING_CODE , PIECE_WORK , IN_TIME , OUT_TIME , PERFORMANCE_CODE , TRANSPORT_CODE , SICK_NOTE_EXPIRY_DATE , SICK_NOTE_RECEIVED_DATE , UNEXCUSED_ABSENCE_FLAG , UNPAID_WORK_ACTION , UNPAID_WORK_BEHAVIOUR , AGREED_TRAVEL_HOUR , CHECK_BOX_1 , CHECK_BOX_2 , HIDDEN_COMMENT_TEXT , IN_CHARGE_STAFF_ID , IN_CHARGE_STAFF_NAME , OFF_PRGREF_ID , CONTACT_PERSON_NAME , TO_ADDRESS_OWNER_CLASS , TO_ADDRESS_ID , UNPAID_WORK_SUPERVISOR , TA_ID , RECORD_SOURCE , CHECK_SUM , PROV_STATE_CODE , PROV_STATE_DESC , voas.SCHEDULED_TRIP_ID, voas.SMS_SCHEDULE_HOURS_BEFORE, voas.EMAIL_SCHEDULE_HOURS_BEFORE, voas.EMAIL_FLAG, voas.SMS_FLAG, SERIES_ID, voas.appearance_type, voas.appearance_location, off_prgref_id, record_source, ce.matter as matter, voas.outcome_reason_code as cancelReasoncode, (case when (event_type = 'CRT') then ( select description from reference_codes where domain = 'CRT_CAN_RSN' and code = voas.outcome_reason_code ) else ( select description from reference_codes where domain = 'APT_CAN_REA' and code = voas.event_outcome ) end ) cancelReasonDesc from V_OFFENDER_ALL_SCHEDULES voas left join court_events ce on (ce.event_id = voas.event_id) 
}
OIIOSCED_OFF_BKG_ONCHECKDELETEMASTER_ {
	SELECT 1 FROM V_OFFENDER_ALL_SCHEDULES V WHERE V.OFFENDER_BOOK_ID = :OFFENDERBOOKID
}
OIIOSCED_LOCATION_NAME{
select agy_loc_id from TEAM_AGENCY_LOC where team_id 
=(select provider_id  from V_COURSE_ACTIVITIES where crs_acty_id 
=(select crs_acty_id from offender_program_profiles where off_prgref_id =:offPrgrefId)) 
}
