GET_SCHEDULES_CUR{
SELECT event_id, offender_id, offender_book_id, offender_id_display, offender_last_name, offender_first_name, living_unit_id, living_unit_desc, event_type, event_type_desc, event_sub_type, event_sub_type_desc, agency_iml_id, agency_iml_desc, to_internal_location_id, to_int_loc_user_desc, reference_id, start_time FROM v_offender_all_schedules ,agency_internal_locations WHERE v_offender_all_schedules.agy_loc_id = :p_agy_loc_id AND v_offender_all_schedules.active_flag = 'Y' AND v_offender_all_schedules.event_status = 'SCH' AND v_offender_all_schedules.event_class = 'INT_MOV' AND TRUNC(v_offender_all_schedules.event_date) = TRUNC(:p_move_date) AND v_offender_all_schedules.booking_active_flag = 'Y' AND v_offender_all_schedules.in_out_status = 'IN' AND v_offender_all_schedules.living_unit_id = agency_internal_locations.internal_location_id AND agency_internal_locations.agy_loc_id = :p_agy_loc_id AND ((start_time >= :p_from_time AND :p_from_time IS NOT NULL and :p_to_time IS NULL) OR (start_time BETWEEN :p_from_time AND :p_to_time) OR (:p_from_time IS NULL AND :p_to_time IS NULL) ) AND ( (lu_level_1_code = :p_living_unit_level_1) OR (:p_living_unit_level_1 IS NULL) ) AND ( (lu_level_2_code = :p_living_unit_level_2) OR (:p_living_unit_level_2 IS NULL) ) AND ( (lu_level_3_code = :p_living_unit_level_3) OR (:p_living_unit_level_3 IS NULL) ) AND ( (agency_iml_level_1_code = :p_agency_iml_level_1) OR (:p_agency_iml_level_1 IS NULL) ) AND ( (agency_iml_level_2_code = :p_agency_iml_level_2) OR (:p_agency_iml_level_2 IS NULL) ) AND ( (agency_iml_level_3_code = :p_agency_iml_level_3) OR (:p_agency_iml_level_3 IS NULL) ) AND ( (to_int_loc_level_1_code = :p_to_int_loc_level_1) OR (:p_to_int_loc_level_1 IS NULL) ) AND ( (to_int_loc_level_2_code = :p_to_int_loc_level_2) OR (:p_to_int_loc_level_2 IS NULL) ) AND ( (to_int_loc_level_3_code = :p_to_int_loc_level_3) OR (:p_to_int_loc_level_3 IS NULL) ) AND ( (offender_id_display = :p_offender_id_display) OR (:p_offender_id_display IS NULL) ) AND ((event_type = :p_event_type) OR (:p_event_type IS NULL)) AND ( (event_sub_type = :p_event_sub_type) OR (:p_event_sub_type IS NULL) ) AND ( (to_internal_location_id = :p_to_int_loc_id) OR (:p_to_int_loc_id IS NULL) ) ORDER BY offender_last_name, offender_first_name
}

GET_UNSCHEDULES_CUR{
SELECT offender_id, offender_book_id, offender_id_display, last_name, first_name, living_unit_id, living_unit_desc, agency_iml_id, agency_iml_desc FROM v_offender_bookings WHERE agy_loc_id = :p_agy_loc_id AND active_flag = 'Y' AND in_out_status = 'IN' AND ( (living_unit_level_1_code = :p_living_unit_level_1) OR (:p_living_unit_level_1 IS NULL) ) AND ( (living_unit_level_2_code = :p_living_unit_level_2) OR (:p_living_unit_level_2 IS NULL) ) AND ( (living_unit_level_3_code = :p_living_unit_level_3) OR (:p_living_unit_level_3 IS NULL) ) AND ( (agency_iml_level_1_code = :p_agency_iml_level_1) OR (:p_agency_iml_level_1 IS NULL AND agency_iml_id IS NULL) ) AND ( (agency_iml_level_2_code = :p_agency_iml_level_2) OR (:p_agency_iml_level_2 IS NULL) ) AND ( (agency_iml_level_3_code = :p_agency_iml_level_3) OR (:p_agency_iml_level_3 IS NULL) ) AND ( (offender_id_display = :p_offender_id_display) OR (:p_offender_id_display IS NULL) ) ORDER BY last_name, first_name
}