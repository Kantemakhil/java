
OTDAACCO_FIND_CGFKGLTXN1TXNTYPE {
 	SELECT TXN_TYPE1.TXN_TYPE CODE ,TXN_TYPE1.DESCRIPTION DESCRIPTION FROM TRANSACTION_TYPES TXN_TYPE1 WHERE TXN_TYPE IN (SELECT TXN_TYPE FROM TRANSACTION_OPERATIONS WHERE MODULE_NAME = 'OTDAACCO' AND CASELOAD_ID = :CASELOADID ) AND TXN_TYPE1.CASELOAD_TYPE = :CASELOADTYPE
}

OTDAACCO_FIND_CGFKGLTXNACCOUNTCODE {
 	SELECT TO_CHAR(AC_CODE1.ACCOUNT_CODE) CODE ,AC_CODE1.ACCOUNT_NAME DESCRIPTION FROM ACCOUNT_CODES AC_CODE1 WHERE ACCOUNT_CODE IN (SELECT DR_ACCOUNT_CODE FROM TRANSACTION_OPERATIONS WHERE MODULE_NAME = 'OTDAACCO' AND TXN_TYPE = :TXNTYPE AND CASELOAD_ID = :CASELOADID ) AND AC_CODE1.CASELOAD_TYPE = :CASELOADTYPE
}

OTDAACCO_FIND_CGFKGLTXN1ACCOUNTCODE {
 	SELECT TO_CHAR(AC_CODE.ACCOUNT_CODE) CODE  ,AC_CODE.ACCOUNT_NAME DESCRIPTION FROM ACCOUNT_CODES AC_CODE WHERE ACCOUNT_CODE IN (SELECT DR_ACCOUNT_CODE FROM TRANSACTION_OPERATIONS WHERE MODULE_NAME = 'OTDAACCO' AND TXN_TYPE = :TXNTYPE AND CASELOAD_ID = :CASELOADID ) AND AC_CODE.CASELOAD_TYPE = :CASELOADTYPE
}

OTDAACCO_GLTXN1_FIND_GL_TRANSACTIONS {
 	SELECT TXN_ID ,TXN_ENTRY_SEQ ,GL_ENTRY_SEQ ,ACCOUNT_PERIOD_ID ,ACCOUNT_CODE ,TXN_ENTRY_DATE ,TXN_TYPE ,TXN_POST_USAGE ,CASELOAD_ID ,OFFENDER_ID ,OFFENDER_BOOK_ID ,TXN_ENTRY_AMOUNT ,TXN_ENTRY_DESC ,TXN_REFERENCE_NUMBER ,BANK_STATEMENT_DATE ,RECON_CLEAR_FLAG ,TXN_REVERSED_FLAG ,REVERSED_TXN_ID ,PAYEE_PERSON_ID ,REVERSED_TXN_ENTRY_SEQ ,REVERSED_GL_ENTRY_SEQ ,PAYEE_CORPORATE_ID ,PAYEE_NAME_TEXT ,TXN_OBJECT_CODE ,LIST_SEQ ,TXN_OBJECT_ID ,CREATE_USER_ID ,CREATE_DATE ,INFO_NUMBER ,DEDUCTION_ID ,TXN_ENTRY_TIME ,RECEIPT_NUMBER ,REVERSAL_REASON_CODE ,TXN_LOC_ID ,PAYEE_CLEAR_FLAG ,CREATE_DATETIME ,MODIFY_DATETIME ,MODIFY_USER_ID ,SEAL_FLAG   FROM GL_TRANSACTIONS  /* where  */
}
OTDAACCO_GLTXN1_INSERT_GL_TRANSACTIONS {
insert into GL_TRANSACTIONS(TXN_ID , TXN_ENTRY_SEQ , GL_ENTRY_SEQ , ACCOUNT_PERIOD_ID , ACCOUNT_CODE , TXN_ENTRY_DATE , TXN_TYPE , TXN_POST_USAGE , CASELOAD_ID , OFFENDER_ID , OFFENDER_BOOK_ID , TXN_ENTRY_AMOUNT , TXN_ENTRY_DESC , TXN_REFERENCE_NUMBER , BANK_STATEMENT_DATE , RECON_CLEAR_FLAG , TXN_REVERSED_FLAG , REVERSED_TXN_ID , PAYEE_PERSON_ID , REVERSED_TXN_ENTRY_SEQ , REVERSED_GL_ENTRY_SEQ , PAYEE_CORPORATE_ID , PAYEE_NAME_TEXT , TXN_OBJECT_CODE , LIST_SEQ , TXN_OBJECT_ID , CREATE_USER_ID , CREATE_DATE , INFO_NUMBER , DEDUCTION_ID , TXN_ENTRY_TIME , RECEIPT_NUMBER , REVERSAL_REASON_CODE , TXN_LOC_ID , PAYEE_CLEAR_FLAG , CREATE_DATETIME , MODIFY_DATETIME , MODIFY_USER_ID , SEAL_FLAG ) values(:txnId , :txnEntrySeq , :glEntrySeq , :accountPeriodId , :accountCode , :txnEntryDate , :txnType , :txnPostUsage , :caseloadId , :offenderId , :offenderBookId , :txnEntryAmount , :txnEntryDesc , :txnReferenceNumber , :bankStatementDate , :reconClearFlag , :txnReversedFlag , :reversedTxnId , :payeePersonId , :reversedTxnEntrySeq , :reversedGlEntrySeq , :payeeCorporateId , :payeeNameText , :txnObjectCode , :listSeq , :txnObjectId , :createUserId , :createDate , :infoNumber , :deductionId , :txnEntryTime , :receiptNumber , :reversalReasonCode , :txnLocId , :payeeClearFlag , CURRENT_TIMESTAMP, , CURRENT_TIMESTAMP, , :modifyUserId , :sealFlag ) 
}

OTDAACCO_SYSTEMPROFILES_FIND_SYSTEM_PROFILES {
 	SELECT PROFILE_TYPE ,PROFILE_CODE ,DESCRIPTION ,PROFILE_VALUE ,PROFILE_VALUE_2 ,MODIFY_USER_ID ,OLD_TABLE_NAME ,CREATE_DATETIME ,CREATE_USER_ID ,MODIFY_DATETIME ,SEAL_FLAG   FROM SYSTEM_PROFILES  /* where  */
}
OTDAACCO_SYSTEMPROFILES_INSERT_SYSTEM_PROFILES {
	INSERT INTO SYSTEM_PROFILES(PROFILE_TYPE ,PROFILE_CODE ,DESCRIPTION ,PROFILE_VALUE ,PROFILE_VALUE_2 ,MODIFY_USER_ID ,OLD_TABLE_NAME ,CREATE_DATETIME ,CREATE_USER_ID ,MODIFY_DATETIME ,SEAL_FLAG ) VALUES(:profileType ,:profileCode ,:description ,:profileValue ,:profileValue2 ,:modifyUserId ,:oldTableName ,CURRENT_TIMESTAMP ,:createUserId ,CURRENT_TIMESTAMP ,:sealFlag )
}

OTDAACCO_SYSTEMPROFILES_UPDATE_SYSTEM_PROFILES {
	UPDATE SYSTEM_PROFILES set PROFILE_TYPE  = :profileType ,PROFILE_CODE  = :profileCode ,DESCRIPTION  = :description ,PROFILE_VALUE  = :profileValue ,PROFILE_VALUE_2  = :profileValue2 ,MODIFY_USER_ID  = :modifyUserId ,OLD_TABLE_NAME  = :oldTableName ,CREATE_DATETIME  = CURRENT_TIMESTAMP ,CREATE_USER_ID  = :createUserId ,MODIFY_DATETIME  = CURRENT_TIMESTAMP ,SEAL_FLAG  = :sealFlag /* where */
}

OTDAACCO_SYSTEMPROFILES_DELETE_SYSTEM_PROFILES { 
	DELETE FROM SYSTEM_PROFILES/* where */
}


OTDAACCO_CGFKCHK_GL_TXN1_GL_TXN_TXN_TY_ {
	SELECT TXN_TYPE1.DESCRIPTION FROM   TRANSACTION_TYPES TXN_TYPE1 WHERE  TXN_TYPE1.TXN_TYPE = :TXNTYPE AND     TXN_TYPE IN (SELECT TXN_TYPE FROM TRANSACTION_OPERATIONS WHERE MODULE_NAME = 'OTDAACCO') AND TXN_TYPE1.CASELOAD_TYPE = :CASELOADTYPE
}

OTDAACCO_CGFKCHK_GL_TXN1_GL_TXN_AC_COD_ {
	SELECT AC_CODE.ACCOUNT_NAME FROM   ACCOUNT_CODES AC_CODE WHERE  AC_CODE.ACCOUNT_CODE = :ACCOUNTCODE AND     ACCOUNT_CODE IN (SELECT DR_ACCOUNT_CODE FROM TRANSACTION_OPERATIONS WHERE MODULE_NAME = 'OTDAACCO' AND TXN_TYPE = :TXNTYPE AND DR_ACCOUNT_CODE NOT IN (SELECT ACCOUNT_CODE FROM CASELOAD_DEDUCTION_PROFILES WHERE CASELOAD_ID = :CASELOADID)) AND AC_CODE.CASELOAD_TYPE= :CASELOADTYPE
}

OTDAACCO_CGWHEN_NEW_FORM_INSTANCE_ {
	SELECT  SYSDATE, USER FROM    SYS.DUAL
}

OTDAACCO_CGFKCHK_GL_TXN_GL_TXN_AC_CODE {
	SELECT AC_CODE1.ACCOUNT_NAME FROM   ACCOUNT_CODES AC_CODE1 WHERE  AC_CODE1.ACCOUNT_CODE = :ACCOUNTCODE AND     ACCOUNT_CODE IN (SELECT DR_ACCOUNT_CODE FROM TRANSACTION_OPERATIONS WHERE MODULE_NAME = 'OTDAACCO' AND TXN_TYPE = :TXNTYPE) AND AC_CODE1.CASELOAD_TYPE = :CASELOADTYPE
}

OTDAACCO_CGRICHK_GL_TRANSACTIONS_ {
	SELECT  '1' FROM    GL_TRANSACTIONS GL_TXN WHERE   (GL_TXN.REVERSED_TXN_ID = P_TXN_ID OR (GL_TXN.REVERSED_TXN_ID IS NULL AND P_TXN_ID IS NULL )) AND     (GL_TXN.REVERSED_TXN_ENTRY_SEQ = P_TXN_ENTRY_SEQ OR (GL_TXN.REVERSED_TXN_ENTRY_SEQ IS NULL AND P_TXN_ENTRY_SEQ IS NULL )) AND     (GL_TXN.REVERSED_GL_ENTRY_SEQ = P_GL_ENTRY_SEQ OR (GL_TXN.REVERSED_GL_ENTRY_SEQ IS NULL AND P_GL_ENTRY_SEQ IS NULL ))
}
OTDAACCO_OVER_DRAFT {
SELECT coalesce (BALANCE, 0) - :PAMOUNT FROM OFFENDER_SUB_ACCOUNTS WHERE CASELOAD_ID = :PCSLD AND OFFENDER_ID = :POFFID AND TRUST_ACCOUNT_CODE = :ACCNTCODE
}
OTDAACCO_OVER_DRAFT_TTT {
SELECT CASELOAD_ID || ' = ' || TO_CHAR (OFFENDER_ID) || ' = ' || TO_CHAR (BALANCE) FROM OFFENDER_SUB_ACCOUNTS WHERE CASELOAD_ID = :PCSLD AND OFFENDER_ID = :POFFID AND TRUST_ACCOUNT_CODE = :ACCNTCODE
}
OTDAACCO_TRANSACTION_TYPES_Y {
SELECT 'Y' FROM TRANSACTION_TYPES WHERE TXN_TYPE = :PTXNTYPE AND CASELOAD_TYPE = (SELECT CASELOAD_TYPE FROM CASELOADS WHERE CASELOAD_ID = :PCSLD ) AND CREDIT_OBLIGATION_TYPE IS NOT NULL
}
OTDAACCO_SUB_ACCOUNT_TYPE {
SELECT SUB_ACCOUNT_TYPE FROM ACCOUNT_CODES WHERE ACCOUNT_CODE = :ACCNTCODE
}
OTDAACCO_MAX_OFFENDER_BOOK_ID {
SELECT MAX (offender_book_id) FROM v_trust_header_a WHERE caseload_id = :PCSLD AND root_offender_id = :POFFID AND booking_type = (select caseload_type from caseloads where caseload_id = :PCSLD )
}
OTDAACCo_TXN_ID {
	SELECT NEXTVAL('TXN_ID') FROM DUAL
}
OTDAACCO_DR_ACCOUNT_CODE {
SELECT SUB_ACCOUNT_TYPE, TXN_POSTING_TYPE FROM ACCOUNT_CODES WHERE ACCOUNT_CODE = :PDRACCOUNTCODE
}
OTDAACCO_CR_ACCOUNT_CODE {
SELECT SUB_ACCOUNT_TYPE, TXN_POSTING_TYPE FROM ACCOUNT_CODES WHERE ACCOUNT_CODE = :PCRACCOUNTCODE
}
OTDAACCO_CHECK_NAVIGATION {
SELECT 'Y' FROM ACCOUNT_CODES WHERE TO_CHAR (ACCOUNT_CODE) = :ACNTCODE AND SUB_ACCOUNT_TYPE IS NOT NULL
}
OTDAACCO_CHK_OFF_ACNT {
SELECT 'Y' FROM TRANSACTION_OPERATIONS WHERE MODULE_NAME = 'OTDAACCO' AND TO_CHAR (BANK_DR_ACCOUNT_CODE) = :ACNTCODE
}
OTDAACCO_ROOT_OFFENDER_ID {
SELECT ROOT_OFFENDER_ID FROM OFFENDERS WHERE OFFENDER_ID_DISPLAY = :POFFIDDSP
}
OTDAACCO_OFF_ID_DISPLAY {
	SELECT LPAD (:OFFID, 10, '0') FROM DUAL
}
OTDAACCO_CURRENT_CASELOAD_VALID {
 SELECT 'Y' FROM OFFENDER_SUB_ACCOUNTS WHERE CASELOAD_ID = :PCASLDID AND OFFENDER_ID = :DROFFID AND TRUST_ACCOUNT_CODE = :DRACCOUNTCODE
}
OTDAACCO_CLOSED_ACCOUNT_VALID {
 SELECT 'Y' FROM OFFENDER_TRUST_ACCOUNTS WHERE CASELOAD_ID = :PCASLDID AND OFFENDER_ID = :DROFFID AND ACCOUNT_CLOSED_FLAG = 'Y'
}
OTDAACCO_P_DR_ACCOUNT_CODE {
 SELECT 'Y' FROM ACCOUNT_CODES WHERE ACCOUNT_CODE = :PDRACCOUNTCODE AND SUB_ACCOUNT_TYPE IN (SELECT CODE FROM REFERENCE_CODES WHERE DOMAIN = 'SUB_AC_TYPE' AND PARENT_CODE = 'R')
}
OTDAACCO_P_CSLD_ID_OTDAACCO_P_DR_ACCOUNT_CODE {
SELECT COUNT(*) FROM CASELOAD_DEDUCTION_PROFILES WHERE CASELOAD_ID = :PCSLDID AND ACCOUNT_CODE = :PDRACCOUNTCODE AND DEDUCTION_TYPE NOT IN (SELECT DEDUCTION_TYPE FROM DEDUCTION_TYPES WHERE DEDUCTION_CATEGORY = 'ALCN')
}
OTDAACCO_P_CR_ACCOUNT_CODE {
SELECT 'Y' FROM ACCOUNT_CODES WHERE ACCOUNT_CODE = :PDRACCOUNTCODE AND SUB_ACCOUNT_TYPE IN (SELECT CODE FROM REFERENCE_CODES WHERE DOMAIN = 'SUB_AC_TYPE' AND PARENT_CODE = 'S')
}
OTDAACCO_GET_OLD_RECORDS_SYSTEMPROFILES {
select * from system_profiles where profile_type=:profile_type and profile_code=:profile_code
}